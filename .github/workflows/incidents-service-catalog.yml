name: Update swagger.yaml repository service-catalog

on:
  push:
    paths:
      - 'swagger.yaml'

jobs:
  update-swagger:
    runs-on: ubuntu-latest
   
    steps:
    - name: Clone githubworkflowA
      uses: actions/checkout@v2

    - name: Clone githubworkflowB
      uses: actions/checkout@v2
      with:
        repository: centralcordoba/githubworkflowB
        token: ${{ secrets.SECRET_WORK_FLOW }}
        path: temp-repo

    - name: Copy swagger.yaml to repository githubworkflowB
      run: |
        cp swagger.yaml temp-repo/swagger.yaml

    # Agregar y hacer commit de los cambios en el repositorio githubworkflowB
    - name: Commit changes to githubworkflowB
      run: |
        cd temp-repo
        git config user.name "centralcordoba"
        git config user.email "lejiei@gmail.com"
        git add .
        git commit -m "Update swagger.yaml"
        git push origin main

    # Crear un PR usando la herramienta de l√≠nea de comandos de GitHub
    - name: Create Pull Request in githubworkflowB
      run: |
        gh pr create --repo centralcordoba/githubworkflowB \
        --base main \
        --head main \
        --title "Update de swagger.yaml" \
        --body "Updated file swagger.yaml from incidents repository." \
        --reviewer centralcordoba
      env:
        GH_TOKEN: ${{ secrets.SECRET_WORK_FLOW }}